<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Swym Editor</title>
    <script src="codemirror/lib/codemirror.js"></script>
    <link rel="stylesheet" href="codemirror/lib/codemirror.css">
    <script src="codemirror/mode/javascript/javascript.js"></script>
    <script src="codemirror/mode/xml/xml.js"></script>
    <script src="codemirror/mode/css/css.js"></script>
    <script src="codemirror/mode/htmlmixed/htmlmixed.js"></script>
    <script type="text/javascript">
    var ipc = require("electron").ipcRenderer;
    var fs = require('fs');

    console.log("test");

    window.onload = function() {
      var myCodeMirror = CodeMirror(document.getElementById('content'), {
        value: "<!DOCTYPE html>\n"+
        "<html>\n"+
        "<head>\n"+
        "</head>\n"+
        "<body>\n"+
        "</body>\n"+
        "</html>",
        mode:  "htmlmixed"
      });

      ipc.on('show-files', function (event, message) {
        console.log("show-files "+message+" "+event);
         message.forEach(function (file) {
           fileNode = document.createElement('li');
           fileNode.innerHTML = file;
           fileNode.addEventListener('click', function() {
             console.log("file? "+file);
             text = ipc.sendSync('load-file-content', file);
             myCodeMirror.setValue(text);
             document.getElementById('iframe_content').contentWindow.document.write(text);
             console.log("load-file-content of "+file+": "+text);
           });
           document.getElementById('files_menu').appendChild(fileNode);
           console.log(file);
         });
      });
    }
    </script>
    <style type="text/css">
      body {
        padding: 0;
        margin: 0;
      }
      #left {
        width: 200px;
        float: left;
        background-color: #fff;
        border-right: 1px solid #c0c;
      }

      #right {
        margin-left: 200px;
        background-color: #fff;
      }

      .clear {
        clear: both;
      }
    </style>
  </head>
  <body>
    <div id="container">
          <div id="left">
            <ul id="files_menu">
            </ul>
          </div>
          <div id="right" style="background-color: blue;">
            <div id="content" style="background-color: green; height: 10px;">Hello</div>
          </div>
          <div class="clear"></div>
          <iframe id="iframe_content" contenteditable="true">
          </iframe>
    </div>
  </body>
</html>
